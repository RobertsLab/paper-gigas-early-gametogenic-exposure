getwd()
setwd("../../") #Set working directory as repository
getwd()
hatchRate <- read.csv("data/2017-07-30-Pacific-Oyster-Larvae/2018-02-14-Hatch-Rate-Data.csv", header = TRUE) #Import hatch rate data
head(hatchRate) #Confirm import
hatchRatepHOnly <- hatchRate[-c(25:26),] #Remove heat shock data
tail(hatchRatepHOnly) #Confirm removal
hatchRatepHOnly$Parental.Treatment <- factor(hatchRatepHOnly$Parental.Treatment) #Make sure residual factors are no longer present
hatchRatepHOnly$Female.Treatment <- factor(hatchRatepHOnly$Female.Treatment) #Make sure residual factors are no longer present
hatchRatepHOnly$Male.Treatment <- factor(hatchRatepHOnly$Male.Treatment) #Make sure residual factors are no longer present
hatchRatepHOnly <- hatchRatepHOnly[-24,] #Remove outlier from Ambient-Ambient group
tail(hatchRatepHOnly) #Confirm removal
hatchRatepHTreatmentANOVA <- aov(Average.Hatch.Rate ~ Parental.Treatment, data = hatchRatepHOnly) #One-way ANOVA by parental treatment
summary(hatchRatepHTreatmentANOVA)[[1]][["F value"]][[1]] #F = 3.10953
summary(hatchRatepHTreatmentANOVA)[[1]][["Pr(>F)"]][[1]] #p = 0.05082859
plot(x = hatchRatepHOnly$Parental.Treatment, y = hatchRatepHOnly$Average.Hatch.Rate, cex.axis = 2) #Preliminary plot. Will modify in InDesign for publication
histologyData <- read.csv("2018-02-27-Gigas-Histology-Classification.csv") #Import histology data
histologyData <- read.csv("2018-02-27-Gigas-Histology-Classification.csv") #Import histology data
head(histologyData) #Confirm import
histologyData <- read.csv("2018-02-27-Gigas-Histology-Classification.csv") #Import histology data
histologyData <- read.csv("analyses/Gonad-Histology/2018-02-27-Histology-Classification-Analyses.R") #Import histology data
head(histologyData) #Confirm import
head(histologyData) #Confirm import
head(histologyData)
View(histologyData)
histologyData <- read.csv("data/2017-Adult-Gigas-Tissue-Sampling/2018-02-27-Gigas-Histology-Classification.csv") #Import histology data
head(histologyData)
histologyData <- read.csv("2018-02-27-Gigas-Histology-Classification.csv") #Import histology data
histologyData <- read.csv("data/2017-Adult-Gigas-Tissue-Sampling/2018-02-27-Gigas-Histology-Classification.csv") #Import histology data
head(histologyData)
mature.stage <- 3 #Set the maturation stage to be anything that is ripe and spawning
histologyData$Mature <- rep(0, nrow(histologyData)) #Create a new column for Yes/No information on maturity. 0 is immature, 1 is mature
histologyData$Mature[which(histologyData$Stage >= mature.stage)] <- rep(1, length(which(histologyData$Stage >= mature.stage))) #For anything where the stage is greater than or equal to the mature.stage, replace it with a 1
head(histologyData) #Confirm changes
histologyData$Treatment <- c(rep("Ambient", times = 20), rep("Low", times = 10), rep("Ambient", times = 10)) #Create a treatment column
head(histologyData) #Confirm changes
histologyData$modifiedSex <- rep(0, nrow(histologyData)) #Create a new column to modify sex classifications
histologyData$modifiedSex[which(histologyData$Sex == "N/A")] <- rep("unripe", length(which(histologyData$Sex == "N/A"))) #For anything where sex is N/A, replace 0 with "unripe"
histologyData$modifiedSex[which(histologyData$Sex == "female")] <- rep("female", length(which(histologyData$Sex == "female"))) #For anything where sex is female, replace 0 with "female"
histologyData$modifiedSex[which(histologyData$Sex == "male")] <- rep("male", length(which(histologyData$Sex == "male"))) #For anything where sex is male, replace 0 with "male"
head(histologyData) #Confirm changes
install.packages("lme4")
library(lme4)
?glmer
mature.glmer1 <- glmer(Mature ~ factor(Treatment) + (1|Tank), family = binomial(link = "logit"), data = histologyData) #Ambient vs. low pH
anova(mature.glm1)
anova(mature.glmer1)
mature.glm2 <- glmer(Mature ~ factor(modifiedSex) + (1|Tank), family = binomial(link = "logit"), data = histologyData) #Female vs. male vs. unripe
anova(mature.glmer2)
mature.glmer2 <- glmer(Mature ~ factor(modifiedSex) + (1|Tank), family = binomial(link = "logit"), data = histologyData) #Female vs. male vs. unripe
anova(mature.glmer2)
mature.glmer3 <- glmer(Mature ~ Ferrous.inclusion.presence + (1|Tank), family = binomial(link = "logit"), data = histologyData) #Ferrous inclusion vs. no ferrous inclusions
anova(mature.glmer3)
mature.glmer4 <- glmer(Mature ~ Pre.or.Post.OA + (1|Tank), family = binomial(link = "logit"), data = histologyData) #Pre vs. post sampling
anova(mature.glmer4)
summary(mature.glmer1)
summary(mature.glmer2)
summary(mature.glmer3)
summary(mature.glmer4)
summary(mature.glmer1)
summary(mature.glmer2)
summary(mature.glmer3)
summary(mature.glmer4)
anova(mature.glmer2)
anova(mature.glmer1)
Anova(mature.glmer1)
summary(mature.glmer2) #AIC  = 27.2
summary(mature.glmer3) #AIC = 39.3
summary(mature.glmer4) #AIC = 39.0
